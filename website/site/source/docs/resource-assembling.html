<%define inDocumentationSection %>
<%define inDocumentationSection.build %>
<%set title = J2ME Polish: Resource Assembling %>
<%set basedir = ../ %>
<%include start.txt %>

	<h1 id="top">Assembling of Resources</h1>
	<ul class="relatedtechnologies">
	<li class="relatedtechnologiesheader">Related Topics:</li>
	<li><a href="customization.html">Customization</a></li>
	<li><a href="localization.html">Localization</a></li>
	<li><a href="preprocessing.html">Preprocessing</a></li>
	</ul>
	<%index %>
	<p>
	<img src="<%= basedir%>images/build-resource-assembling-structure.png"  width="321" height="453" alt="Example Resource Structure" />
	</p>
	<h2 id="concepts">Concepts</h2>
	<p>
	During the build process resources like images, sound files etc. 
	are assembled autmatically for each device.
	</p><p>
Place all your resources into the <i>${project.home}/resources</i> folder (when no other directory has been specified 
in the <a href="build-build.html#resources">&lt;resources&gt; element</a> or with the 
&quot;resDir&quot;-attribute of the <a href="build-build.html">&lt;build&gt; element</a> in your <i>build.xml</i> script).
	</p>
	<p>
	In case you have specific resource that only should be added for some devices, you can put these into
	correspondingly names subfolders of the <i>resources</i> directory.
	<br />
	You can have the resource <i>bg.png</i> in both the <i>resources</i> as well as the <i>resources/ScreenSize.240+x320+</i>
	folders, for example. When you now build your application for a device with a screen size of at least
	240 pixels wide and 320 pixels high, the resources from <i>resources/ScreenSize.240+x320+</i> will
	be included in your application - they will overwrite generic resources with the same name that are
	placed in the <i>resources</i> directory.
	</p>
	<p>
Resources for devices of specific vendors  can be placed into the &quot;resources/[vendor-name]&quot; folder, e.g. the &quot;resources/Nokia&quot; folder for Nokia devices. Resources for a specific device can be placed into the &quot;resources/[vendor-name]/[device-name]&quot; folder, e.g. the folder &quot;resources/Nokia/N95&quot; for Nokia/N95 devices. 
	</p><p>
	You can refer to any device capability that has been defined in the device database for 
	</p><p>
All resources will be copied to the root of the application and more specific resources will overwrite the common resources: If you have a picture named &quot;hello.png&quot; in the &quot;resources&quot; folder as well as in the &quot;resources/Nokia&quot; and in the &quot;resources/Nokia/6600&quot; folder, the version in the &quot;resources&quot; folder will be used for all non-Nokia devices, the version contained in the &quot;resources/Nokia&quot; folder will be used for all Nokia devices, but the image &quot;resources/Nokia/6600/hello.png&quot; will be used for the application which is build for the Nokia/6600 phone. 
<br/>
In the application code you can load this image as any other resource from the root: 
</p>
<pre>
Image.createImage( &quot;/hello.png&quot; );
</pre>
	<p>In case you want to include subfoldersin your application's JAR file, you need to use a <a href="#root">root directory</a>
	with enabled <code>includeSubDirs</code> attribute. Please see below for more details.
	</p>
	<p>
	The adjustments of designs for different devices is described in the 
	<a href="css-groups.html">CSS-documentation</a>.
	</p>
	<h2 id="groups">Often Used Directories</h2>
	<p>
	Here are some examples for commonly used directory names:
	</p>
	
	<table class="borderedTable"  cellspacing="0" cellpadding="3" border="1">
	<tr><th>Group</th><th>Type</th><th>Default Folder</th><th>Explanation</th></tr>
	<tr>
	 <td>IconSize.16x16</td>
	 <td>Capability</td>
	 <td>resources/IconSize.16x16</td>
	 <td>Folder for different icon sizes of the target devices, e.g. <i>IconSize.16x16</i> or <i>IconSize.56x56</i> and so on. You can use
	 the <i>IconSize.0x0</i> for storing icon resources for devices with an unknown <code>IconSize</code> capability.
	 </td>
	</tr>
	<tr>
	 <td>ScreenSize.176x208</td>
	 <td>Screen</td>
	 <td>resources/ScreenSize.176x208</td>
	 <td>Folder for different screen sizes of the target devices, e.g. ScreenSize.176x208 or ScreenSize.128x128 and so on. </td>
	</tr>
	<tr>
	 <td>ScreenSize.240+x320+</td>
	 <td>Screen</td>
	 <td>resources/ScreenSize.240+x320+</td>
	 <td>Folder for devices with screens that are as large or larger than the specified screen size. In the example the screen needs to be at least 240 pixels wide and 320 pixel high so that resources from that folder are included.</td>
	</tr>
	<tr>
	 <td>CanvasSize.176x208</td>
	 <td>Canvas</td>
	 <td>resources/CanvasSize.176x208</td>
	 <td>Folder for different canvas sizes of the target devices, e.g. CanvasSize.176x208 or CanvasSize.128x128 and so on. </td>
	</tr>
	<tr>
	 <td>CanvasSize.170+x200+</td>
	 <td>Canvas</td>
	 <td>resources/CanvasSize.170+x200+</td>
	 <td>Folder for devices with canvassses that are as large or larger than the specified canvas size. In the example the canvas needs to be at least 170 pixels wide and 200 pixel high so that resources from that folder are included.</td>
	</tr>
	<tr>
	 <td>FullCanvasSize.176x208</td>
	 <td>FullCanvas</td>
	 <td>resources/CFullanvasSize.176x208</td>
	 <td>Folder for different canvas sizes in fullscreen-mode of the target devices, e.g. FullCanvasSize.176x208 or FullCanvasSize.128x128 and so on. </td>
	</tr>
	<tr>
	 <td>FullCanvasSize.170+x200+</td>
	 <td>Canvas</td>
	 <td>resources/FullCanvasSize.170+x200+</td>
	 <td>Folder for devices with canvassses that are as large or larger than the specified canvas size in fullscreen-mode. In the example the canvas needs to be at least 170 pixels wide and 200 pixel high in the fullscreen-mode so that resources from that folder are included.</td>
	</tr>
	<tr>
	 <td>mp3</td>
	 <td>audio</td>
	 <td>resources/mp3</td>
	 <td>For devices which support the MP3 sound format.</td>
	</tr>
	<tr>
	 <td>amr</td>
	 <td>audio</td>
	 <td>resources/amr</td>
	 <td>For devices which support the AMR sound format.</td>
	</tr>
	<tr>
	 <td>midi</td>
	 <td>audio</td>
	 <td>resources/midi</td>
	 <td>For devices which support the MIDI sound format.</td>
	</tr>
	<tr>
	 <td>polish.audio.mp3 and not polish.audio.amr</td>
	 <td>Preprocessing Term</td>
	 <td>resources/polish.audio.mp3 and not polish.audio.amr</td>
	 <td>You can use any preprocessing term as a directory name as well.</td>
	</tr>
	<tr>
	 <td>mpeg-4</td>
	 <td>video</td>
	 <td>resources/mpeg-4</td>
	 <td>For devices which support the MPEG-4 video format.</td>
	</tr>
	<tr>
	 <td>3gpp</td>
	 <td>video</td>
	 <td>resources/3gpp</td>
	 <td>For devices which support the 3GPP video format.</td>
	</tr>
	</table>

	<h2 id="root">Structure Your Resources with Root Directories</h2>
	<p>
	While the default resource assembling mechanism is quite powerful, you might want to structure
	your resources a bit better or include subdirectories in your application as well. 
	Your can easily achieve this by defining <code>&lt;root&gt;</code> elements in your 
	<i>build.xml</i> script:
	</p>
<pre>
&lt;resources
	dir=&quot;resources/base&quot;
	defaultexcludes=&quot;yes&quot;
	excludes=&quot;readme.txt&quot;
&gt;
	&lt;root dir=&quot;resources/base/design&quot; /&gt;
	&lt;root dir=&quot;resources/base/sounds&quot; /&gt;
	&lt;root dir=&quot;resources/base/images&quot; /&gt;
	&lt;root dir=&quot;resources/base/images/largescreens&quot; 
		if=&quot;polish.ScreenWidth &amp;gt;= 240 and polish.ScreenHeight &amp;gt;= 300&quot; 
	/&gt;
	&lt;root dir=&quot;resources/base/images/i18n&quot; 
		includeSubDirs=&quot;true&quot; includeBaseDir=&quot;true&quot; excludes=&quot;CVS, readme*&quot; 
	/&gt;
&lt;/resources&gt;
</pre>
	<p>
	Now you can put all sounds, images and the polish.css design into their own subfolder hierarchy. 
	Each <code>&lt;root /&gt;</code> provides another starting point for the normal resource assembling
	mechanism described above.
	</p>
	<p>Sometimes you will want to keep subfolders for your resources as well. You might want to add all
	<a href="localization.html">localization</a> dependent
	resources, for example, and allow your user to switch the localization dynamically. Image following
	resource structure with the language dependent <i>flag.png</i> resource:
	</p>
<pre>
resources/base/images/i18n/en/flag.png
resources/base/images/i18n/de/flag.png
resources/base/images/i18n/dk/flag.png
resources/base/images/i18n/fr/flag.png
resources/base/images/i18n/es/flag.png
resources/base/images/i18n/cn/flag.png
</pre>
	<p>You can include the complete <i>i18n</i> directory with all its subfolders with this
	<code>&lt;root /&gt;</code> definition with activated <code>includeSubDirs=&quot;true&quot;</code> setting:
	<p>
<pre>
&lt;root dir=&quot;resources/base/images/i18n&quot; 
	includeSubDirs=&quot;true&quot; includeBaseDir=&quot;true&quot; excludes=&quot;CVS, readme*&quot; 
/&gt;
</pre>
	<p>
	You can now load the language dependent resource with this code:
	</p>
<pre>
Image flag = Image.createImage( "i18n/" + Locale.LANGUAGE + "/flag.png" );
</pre>

	<h2 id="finetune">Fine Tuning the Resource Assembling</h2>
	<p>
	Sometimes it is necessary to adjust the resource assembling. 
	</p><p>
	<pre>
Imagine the situation where you have an application which uses MP3 soundfiles when the device supports MP3, and MIDI soundfiles when the device supports MIDI. In the source code you can use the preprocessing symbols &quot;polish.audio.mp3&quot; and &quot;polish.audio.midi&quot; to distinguish between these cases:
//#ifdef polish.audio.mp3
	// okay play the mp3 sound
//#elifdef polish.audio.midi
	// play midi sound instead
//#endif
</pre>
</p><p>
The situation is different in the resource assembling step, though. Obviously you can put all MP3-files into the &quot;resources/mp3&quot; folder and all MIDI-files into the &quot;resources/midi&quot;-folder, so that these resources are available when they are needed. But for devices which support both MP3 as well as MIDI sound, the application will contain the MIDI files as well, even though only the MP3 files are actually needed.
</p><p>
For such cases you can define file-sets in the build.xml which will be included when specific conditions are fulfilled:
<pre>
&lt;resources
	dir=&quot;resources&quot;
	excludes=&quot;readme*&quot; 
&gt;
	&lt;fileset 
		dir=&quot;resources/multimedia&quot; 
		includes=&quot;*.mp3&quot; 
		if=&quot;polish.audio.mp3&quot; 
	/&gt;
	&lt;fileset 
		dir=&quot;resources/multimedia&quot; 
		includes=&quot;*.mid&quot; 
		if=&quot;polish.audio.midi and not polish.audio.mp3&quot; 
	/&gt;
&lt;/resources&gt;
</pre>
</p><p>
In the above example MIDI files are only included when two conditions are met:
<br />1) The device supports MIDI sound
<br />2) The device does not support MP3 sound.
</p><p>
The <a href="build-build.html#resources">&lt;resources&gt;-element</a> is a subelement of 
the <a href="build-build.html">&lt;build&gt;-section</a>. 
An often used attribute is the &amp;quot;exclude&amp;quot;-attribute which specifies any files
 which should not be included into the application bundle. You can have readme-files 
 for example with background information for designers. In the above example all 
 files starting with &amp;quot;readme&amp;quot; are excluded from the final 
 application JAR file.
</p><p>
The &lt;resources&gt;-element is also responsible for the localization of the application, which is discussed in the following chapter.
	</p><p>
On a final note please remember not to use the &amp;quot;resDir&amp;quot;-attribute of the &lt;build&gt;-element when you use the &lt;resources&gt;-element, since this will yield unpredictable results.
	</p>
	
<%include end.txt %>